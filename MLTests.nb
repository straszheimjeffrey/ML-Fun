(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     35016,        843]
NotebookOptionsPosition[     33299,        779]
NotebookOutlinePosition[     33653,        795]
CellTagsIndexPosition[     33610,        792]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"SetDirectory", "[", "\"\<~/Math/ML-Fun\>\"", "]"}]], "Input"],

Cell[BoxData["\<\"/Users/straszheimjeffrey/Math/ML-Fun\"\>"], "Output",
 CellChangeTimes->{
  3.547940804609194*^9, 3.547940962983262*^9, 3.5479417014799423`*^9, 
   3.548010704166665*^9, {3.54801078712105*^9, 3.548010805482082*^9}, 
   3.548011520254665*^9, 3.548011606214096*^9, {3.548013184987359*^9, 
   3.548013206252191*^9}, 3.548023507778174*^9, 3.548024552232877*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"<<", "ML`"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"noisematrix", "[", "r_", "]"}], ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"RandomVariate", "[", 
     RowBox[{"CauchyDistribution", "[", 
      RowBox[{"0", ",", "1"}], "]"}], "]"}], ",", 
    RowBox[{"{", "r", "}"}], ",", 
    RowBox[{"{", "6", "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.548006129549099*^9, 3.5480061888920107`*^9}, {
  3.5480064609558563`*^9, 3.5480064804755096`*^9}, {3.548006760867422*^9, 
  3.548006761395356*^9}, {3.5480073453847523`*^9, 3.548007345919505*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"makesample", "[", "mat_", "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"factor1", " ", "=", 
       RowBox[{"RandomVariate", "[", 
        RowBox[{"BinomialDistribution", "[", 
         RowBox[{"3", ",", ".5"}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"factor2", "=", 
       RowBox[{"RandomVariate", "[", 
        RowBox[{"DiscreteUniformDistribution", "[", 
         RowBox[{"{", 
          RowBox[{"0", ",", "2"}], "}"}], "]"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"factor3", "=", 
       RowBox[{"RandomVariate", "[", 
        RowBox[{"DiscreteUniformDistribution", "[", 
         RowBox[{"{", 
          RowBox[{"1", ",", "8"}], "}"}], "]"}], "]"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"sample", "[", 
     RowBox[{
      RowBox[{"factor1", "+", "factor2", "+", "factor3"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"mat", ".", 
       RowBox[{"{", 
        RowBox[{
        "factor1", ",", "factor2", ",", "factor3", ",", "\[IndentingNewLine]", 
         RowBox[{"RandomVariate", "[", 
          RowBox[{"NormalDistribution", "[", "]"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"RandomVariate", "[", 
          RowBox[{"NormalDistribution", "[", 
           RowBox[{"0", ",", "5"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
         
         RowBox[{"RandomVariate", "[", 
          RowBox[{"StudentTDistribution", "[", 
           RowBox[{"0", ",", "1", ",", "2"}], "]"}], "]"}]}], "}"}]}]}], 
     "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.548006573159328*^9, 3.5480066017760363`*^9}, {
  3.5480066631750402`*^9, 3.548007065641075*^9}, {3.5480070964536123`*^9, 
  3.548007331656747*^9}, {3.548007384339274*^9, 3.548007479890966*^9}, {
  3.548007579621992*^9, 3.548007601129795*^9}, {3.548008952121584*^9, 
  3.548008984114023*^9}, {3.548009060183824*^9, 3.548009066375353*^9}, {
  3.54800910737628*^9, 3.548009107466304*^9}, {3.548009159646323*^9, 
  3.54800918791605*^9}, {3.5480103579022007`*^9, 3.548010358246711*^9}, {
  3.54801039980993*^9, 3.5480104141081333`*^9}, {3.5480104964094353`*^9, 
  3.548010568541327*^9}, {3.548011023411751*^9, 3.54801103873564*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"testnoise", "=", 
   RowBox[{"noisematrix", "[", "15", "]"}]}], ";", 
  RowBox[{"testnoise", "//", "MatrixForm"}]}]], "Input",
 CellChangeTimes->{{3.548007351875379*^9, 3.548007372287718*^9}, {
  3.548007490572806*^9, 3.548007533880982*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.04531404663925684`", "1.4790012482480706`", "1.2031065302298167`", 
      RowBox[{"-", "4.2413791789463495`"}], "0.40680769934948857`", 
      RowBox[{"-", "0.19093819877125823`"}]},
     {"2.3710572561311003`", "0.07372588949044953`", 
      RowBox[{"-", "1.630502246873347`"}], 
      RowBox[{"-", "1.5133882415221378`"}], "1.9927072548809592`", 
      "0.06999081101088277`"},
     {"0.5655840001398739`", "0.14055424861989102`", "0.48405571198526887`", 
      "1.0129362926845698`", "1.0613806517175381`", "0.14086488244368683`"},
     {"5.444459654242485`", "0.24859136252282574`", "22.2062304954809`", 
      "2.4992710465818564`", 
      RowBox[{"-", "3.414765079628072`"}], 
      RowBox[{"-", "1.1864728909165119`"}]},
     {"3.205361315067585`", "0.8952387262094399`", 
      RowBox[{"-", "0.5911313228366429`"}], 
      RowBox[{"-", "1.0236387156626328`"}], "233.07192221054498`", 
      RowBox[{"-", "3.881168944445626`"}]},
     {"1.4166422175587956`", "2.3212530323041882`", "2.6482180210884523`", 
      RowBox[{"-", "0.2296966975622909`"}], "0.5846898332798849`", 
      "0.5082739243605764`"},
     {
      RowBox[{"-", "0.6570906740105785`"}], 
      RowBox[{"-", "4.513418052944468`"}], "0.5505599954225118`", 
      "1.462440063170204`", 
      RowBox[{"-", "0.7437271163437545`"}], "1.2830671667826408`"},
     {"12.995689184684181`", 
      RowBox[{"-", "1.6550810286092814`"}], "0.27283192376378523`", 
      "8.024991595915212`", 
      RowBox[{"-", "0.7401164380771709`"}], "0.03902252608501488`"},
     {"11.39238803835035`", "67.28070997665567`", "1.2108671462506917`", 
      "3.377877539386357`", 
      RowBox[{"-", "0.53582664074436`"}], 
      RowBox[{"-", "1.6798133684865348`"}]},
     {
      RowBox[{"-", "26.199238024607514`"}], 
      RowBox[{"-", "0.5016940039225409`"}], 
      RowBox[{"-", "1.5675357420291989`"}], "0.20137205922086412`", 
      "0.4040045871006048`", 
      RowBox[{"-", "0.7651919717577211`"}]},
     {
      RowBox[{"-", "0.28972934827541097`"}], "0.374524733531836`", 
      "0.06720333610292675`", 
      RowBox[{"-", "0.10203732631582467`"}], "0.9666525141337095`", 
      "0.38444824631686475`"},
     {
      RowBox[{"-", "1.0875697741122876`"}], 
      RowBox[{"-", "0.5313030431150342`"}], "1.7975362385120182`", 
      "0.0874188700345215`", "1.5093401129264994`", 
      RowBox[{"-", "1.0078486730374456`"}]},
     {
      RowBox[{"-", "0.030721176624902636`"}], 
      RowBox[{"-", "0.6925337832737962`"}], 
      RowBox[{"-", "0.4444291416750009`"}], 
      RowBox[{"-", "8.845545284213602`"}], "1.7886620800581265`", 
      RowBox[{"-", "0.7790920621783886`"}]},
     {
      RowBox[{"-", "0.8191850432382215`"}], 
      RowBox[{"-", "4.339848663717549`"}], "0.8934485298143392`", 
      "0.029884737420781356`", 
      RowBox[{"-", "2.671350173216639`"}], 
      RowBox[{"-", "5.151228453015664`"}]},
     {"2.654000996034505`", 
      RowBox[{"-", "3.4939926973507425`"}], 
      RowBox[{"-", "1.946524489194713`"}], 
      RowBox[{"-", "0.6357600551878765`"}], "1.6228472041686226`", 
      RowBox[{"-", "0.6989388700673039`"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.54801070437932*^9, {3.5480107872496977`*^9, 3.548010805631876*^9}, 
   3.548011520402684*^9, 3.548011606364601*^9, {3.5480131851535378`*^9, 
   3.548013206380796*^9}, 3.548023508087278*^9, 3.548024552513608*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"testdata", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"makesample", "[", "testnoise", "]"}], ",", 
     RowBox[{"{", "1000", "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.548007564457863*^9, 3.548007571840703*^9}, {
  3.5480076096830053`*^9, 3.548007627039755*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Take", "[", 
   RowBox[{"testdata", ",", "10"}], "]"}], "//", "TableForm"}]], "Input",
 CellChangeTimes->{{3.5480076306392517`*^9, 3.5480076548309917`*^9}}],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{"sample", "[", 
       RowBox[{"10", ",", 
        RowBox[{"{", 
         RowBox[{"8.005513391240735`", ",", 
          RowBox[{"-", "2.986562922669773`"}], ",", "3.590209994577645`", ",",
           "132.05949421231745`", ",", 
          RowBox[{"-", "193.778757520273`"}], ",", "21.27546452511332`", ",", 
          
          RowBox[{"-", "8.05167985098059`"}], ",", "39.293454612178955`", ",",
           "176.93536865918855`", ",", 
          RowBox[{"-", "87.30200483618094`"}], ",", 
          RowBox[{"-", "0.8782875954732724`"}], ",", "3.9498699100169388`", 
          ",", 
          RowBox[{"-", "6.601889633715239`"}], ",", 
          RowBox[{"-", "1.2922602005329513`"}], ",", 
          RowBox[{"-", "9.898885188776744`"}]}], "}"}]}], "]"}]},
     {
      RowBox[{"sample", "[", 
       RowBox[{"6", ",", 
        RowBox[{"{", 
         RowBox[{
         "14.009431885618131`", ",", "20.064958822048553`", ",", 
          "12.942692946336603`", ",", "34.7538964742512`", ",", 
          "2513.1333808341697`", ",", "20.175122872833892`", ",", 
          RowBox[{"-", "17.73499303102227`"}], ",", 
          RowBox[{"-", "2.9979158464955824`"}], ",", "142.4116532199483`", 
          ",", 
          RowBox[{"-", "27.282396241983072`"}], ",", "10.920376357841073`", 
          ",", "19.96525726125737`", ",", "22.998098676286038`", ",", 
          RowBox[{"-", "32.77666122325235`"}], ",", "8.099867417680368`"}], 
         "}"}]}], "]"}]},
     {
      RowBox[{"sample", "[", 
       RowBox[{"4", ",", 
        RowBox[{"{", 
         RowBox[{
         "5.254635388287383`", ",", "17.689635213221354`", ",", 
          "10.984981645215923`", ",", "27.810711185803402`", ",", 
          "1931.6470834239508`", ",", "12.78183611435178`", ",", 
          RowBox[{"-", "6.490964905100965`"}], ",", "21.654016126498274`", 
          ",", "21.77421852649597`", ",", 
          RowBox[{"-", "51.94999466860706`"}], ",", "7.417104253674871`", ",",
           "14.185508783164547`", ",", "12.675808101626092`", ",", 
          RowBox[{"-", "20.470053727276103`"}], ",", "14.919602281700675`"}], 
         "}"}]}], "]"}]},
     {
      RowBox[{"sample", "[", 
       RowBox[{"6", ",", 
        RowBox[{"{", 
         RowBox[{"10.941473885278304`", ",", 
          RowBox[{"-", "1.2132494090681558`"}], ",", 
          RowBox[{"-", "0.6390561551089864`"}], ",", "77.89160993039792`", 
          ",", 
          RowBox[{"-", "434.98789573708893`"}], ",", "13.31732323983002`", 
          ",", 
          RowBox[{"-", "2.792128243986883`"}], ",", "13.602279235958967`", 
          ",", "86.12644955827521`", ",", 
          RowBox[{"-", "60.09409565241416`"}], ",", 
          RowBox[{"-", "0.9333257374027855`"}], ",", 
          RowBox[{"-", "2.130975283409459`"}], ",", "7.4734392673996055`", 
          ",", 
          RowBox[{"-", "7.858362942763959`"}], ",", 
          RowBox[{"-", "7.3129465469141515`"}]}], "}"}]}], "]"}]},
     {
      RowBox[{"sample", "[", 
       RowBox[{"8", ",", 
        RowBox[{"{", 
         RowBox[{
         "7.567593135158253`", ",", "8.253976965226864`", ",", 
          "12.643470782409386`", ",", "93.4973542880821`", ",", 
          "1826.7706264763572`", ",", "23.41759211230372`", ",", 
          RowBox[{"-", "11.642614323124599`"}], ",", "14.156511651977358`", 
          ",", "152.24093284392555`", ",", 
          RowBox[{"-", "31.347276646615793`"}], ",", "8.09392142651815`", ",",
           "19.153039260905413`", ",", "0.8478330224262058`", ",", 
          RowBox[{"-", "23.840579433114904`"}], ",", 
          RowBox[{"-", "1.7900221946952244`"}]}], "}"}]}], "]"}]},
     {
      RowBox[{"sample", "[", 
       RowBox[{"9", ",", 
        RowBox[{"{", 
         RowBox[{"3.3222535068489067`", ",", 
          RowBox[{"-", "16.12460809363077`"}], ",", "2.6941121748444368`", 
          ",", "170.47650149690642`", ",", 
          RowBox[{"-", "661.9847136487978`"}], ",", "21.713706832436866`", 
          ",", "5.861000655400782`", ",", "24.850903707340024`", ",", 
          "88.18567264541562`", ",", 
          RowBox[{"-", "40.58213736159274`"}], ",", 
          RowBox[{"-", "1.2490102440138187`"}], ",", "4.196668632201364`", 
          ",", 
          RowBox[{"-", "21.276966366476508`"}], ",", 
          RowBox[{"-", "4.995920862090765`"}], ",", 
          RowBox[{"-", "21.585154229710174`"}]}], "}"}]}], "]"}]},
     {
      RowBox[{"sample", "[", 
       RowBox[{"6", ",", 
        RowBox[{"{", 
         RowBox[{"2.929965229114542`", ",", 
          RowBox[{"-", "2.8610370679210746`"}], ",", "9.228322682556545`", 
          ",", "121.28185411335251`", ",", "1062.0876297449568`", ",", 
          "18.21197359519728`", ",", "1.9706709894508094`", ",", 
          "9.899885033470602`", ",", "9.784569731070036`", ",", 
          RowBox[{"-", "7.232606542362502`"}], ",", "4.66478864947287`", ",", 
          "17.862153624597717`", ",", 
          RowBox[{"-", "7.291141949120711`"}], ",", 
          RowBox[{"-", "6.617965187562964`"}], ",", 
          RowBox[{"-", "5.145087684366836`"}]}], "}"}]}], "]"}]},
     {
      RowBox[{"sample", "[", 
       RowBox[{"6", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1.7411946026308058`"}], ",", 
          RowBox[{"-", "4.184692149484911`"}], ",", "2.054061834106544`", ",",
           "66.80637983137284`", ",", 
          RowBox[{"-", "380.1640896203944`"}], ",", "10.859973870971169`", 
          ",", 
          RowBox[{"-", "7.113424485894721`"}], ",", "37.153965513470126`", 
          ",", "167.90649362724602`", ",", 
          RowBox[{"-", "56.03566831889972`"}], ",", 
          RowBox[{"-", "1.9059133548534386`"}], ",", 
          RowBox[{"-", "0.899366501383545`"}], ",", 
          RowBox[{"-", "18.48901980823941`"}], ",", "1.7586903215112253`", 
          ",", 
          RowBox[{"-", "8.513255563152613`"}]}], "}"}]}], "]"}]},
     {
      RowBox[{"sample", "[", 
       RowBox[{"6", ",", 
        RowBox[{"{", 
         RowBox[{"9.950042025060679`", ",", 
          RowBox[{"-", "0.8471657325795668`"}], ",", "1.7116140592829199`", 
          ",", "70.05018960642968`", ",", "46.91385502784156`", ",", 
          "14.272133190559362`", ",", 
          RowBox[{"-", "9.330637528338416`"}], ",", "4.204603836980417`", ",",
           "146.94504656181596`", ",", 
          RowBox[{"-", "31.96252733062736`"}], ",", "0.9051028461533184`", 
          ",", "3.4829108160544155`", ",", "4.395347792804167`", ",", 
          RowBox[{"-", "7.175912300488084`"}], ",", 
          RowBox[{"-", "9.366269394826395`"}]}], "}"}]}], "]"}]},
     {
      RowBox[{"sample", "[", 
       RowBox[{"11", ",", 
        RowBox[{"{", 
         RowBox[{"13.580159575930546`", ",", 
          RowBox[{"-", "5.621333219003482`"}], ",", "4.391202852073924`", ",",
           "165.27299444864568`", ",", "22.34163465234739`", ",", 
          "26.19836143950888`", ",", 
          RowBox[{"-", "7.196836783406543`"}], ",", "20.584447334307868`", 
          ",", "164.0289464582865`", ",", 
          RowBox[{"-", "64.48300918280232`"}], ",", "0.785125157167294`", ",",
           "9.365177785892714`", ",", 
          RowBox[{"-", "0.10506667548057155`"}], ",", 
          RowBox[{"-", "4.556702596472461`"}], ",", 
          RowBox[{"-", "14.90432012957927`"}]}], "}"}]}], "]"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.54800764033287*^9, 3.548007655730245*^9}, 
   3.548009076859467*^9, 3.548009115139039*^9, {3.548009171796578*^9, 
   3.5480091932731533`*^9}, 3.548010583369185*^9, 3.54801070481249*^9, {
   3.5480107876765137`*^9, 3.5480108060653963`*^9}, 3.54801105053736*^9, 
   3.548011520823785*^9, 3.548011606761119*^9, 3.548013119535692*^9, {
   3.548013185552878*^9, 3.548013206795648*^9}, 3.5480235085550337`*^9, 
   3.548024552933207*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TallyClasses", "[", "testdata", "]"}]], "Input",
 CellChangeTimes->{{3.548009613014698*^9, 3.54800961640644*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "6", ",", "29", ",", "70", ",", "88", ",", "116", ",", "121", ",", "119", 
   ",", "110", ",", "137", ",", "111", ",", "64", ",", "28", ",", "1"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.548009617082377*^9, 3.5480105868187113`*^9, 3.5480107048396387`*^9, {
   3.548010787709004*^9, 3.5480108060956573`*^9}, 3.548011055994869*^9, 
   3.548011520850718*^9, 3.5480116067901983`*^9, 3.548013122606386*^9, {
   3.548013185584509*^9, 3.548013206828998*^9}, 3.548022669952972*^9, {
   3.548022785760992*^9, 3.548022826350525*^9}, 3.5480235085892344`*^9, 
   3.548024552976905*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "/@", 
  RowBox[{"FullMatrix", "/@", 
   RowBox[{"GatherData", "[", 
    RowBox[{"Take", "[", 
     RowBox[{"testdata", ",", "15"}], "]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.5480096344565067`*^9, 3.548009646999192*^9}, 
   3.548011864171509*^9, {3.548012116695486*^9, 3.548012116809478*^9}, {
   3.5480125621800833`*^9, 3.5480126817785*^9}, {3.548012723168676*^9, 
   3.54801278145337*^9}, {3.5480128310306063`*^9, 3.548012865501111*^9}, {
   3.5480129239240723`*^9, 3.548013013951591*^9}, {3.548013046745027*^9, 
   3.548013052820716*^9}, {3.548013145330696*^9, 3.548013146834303*^9}, {
   3.5480238594265823`*^9, 3.548023936566551*^9}, {3.5480239774166107`*^9, 
   3.548023992797036*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "5", ",", "0", ",", "2", 
   ",", "4", ",", "2", ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{{3.5480130024986153`*^9, 3.548013014911685*^9}, {
   3.548013103257805*^9, 3.548013147372476*^9}, {3.548013185615788*^9, 
   3.5480132068610067`*^9}, 3.548023508630884*^9, {3.5480238488924427`*^9, 
   3.548023892102086*^9}, {3.5480239276780777`*^9, 3.5480239375614023`*^9}, {
   3.54802397894845*^9, 3.548023993446023*^9}, 3.548024553006407*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ClassesFromGathered", "[", 
  RowBox[{"GatherData", "[", "testdata", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.5480099958544083`*^9, 3.548010012437141*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6", ",", "7", ",", "8", 
   ",", "9", ",", "10", ",", "11", ",", "12", ",", "13"}], "}"}]], "Output",
 CellChangeTimes->{
  3.5480100136960087`*^9, 3.5480106027828407`*^9, 3.548010704909848*^9, {
   3.548010787792307*^9, 3.54801080617274*^9}, 3.548011062373642*^9, 
   3.548011520916965*^9, 3.5480116068598213`*^9, 3.548013154305853*^9, {
   3.5480131856466427`*^9, 3.54801320689179*^9}, 3.5480235086722603`*^9, 
   3.548024553039051*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"fullmean", ",", "fullsd"}], "}"}], "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m", "=", 
       RowBox[{"FullMatrix", "[", "testdata", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Mean", "[", "m", "]"}], ",", 
       RowBox[{"StandardDeviation", "[", "m", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.5480111266779413`*^9, 3.548011179521242*^9}, 
   3.548011276614768*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{"fullmean", ",", "fullsd"}], "}"}], "//", "TableForm"}]], "Input",
 CellChangeTimes->{{3.548011365516596*^9, 3.5480113665359097`*^9}, {
  3.5480115314923143`*^9, 3.5480115414844112`*^9}}],

Cell[BoxData[
 TagBox[GridBox[{
    {"7.070284171946913`", 
     RowBox[{"-", "3.923937144753403`"}], "3.055161443762286`", 
     "109.15053511167385`", 
     RowBox[{"-", "17.62179378695437`"}], "16.385509642661226`", 
     RowBox[{"-", "3.18359098914972`"}], "18.85179725684775`", 
     "91.75266100990146`", 
     RowBox[{"-", "46.64775787452561`"}], "0.14196868696881046`", 
     "5.901108152652254`", 
     RowBox[{"-", "2.7354299580759824`"}], 
     RowBox[{"-", "1.0069050432996238`"}], 
     RowBox[{"-", "8.519572791954637`"}]},
    {"5.563488356518426`", "10.903686406969666`", "5.598003392359936`", 
     "54.87292585420946`", "1165.336822884913`", "7.1924395344143255`", 
     "6.58106190072303`", "14.445516545820015`", "56.04314637485091`", 
     "23.11961083540005`", "4.942006685790035`", "9.057562577619573`", 
     "12.4671739225053`", "19.71978680777125`", "10.07202659653981`"}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.5480113679499607`*^9, {3.5480115209627323`*^9, 3.5480115420405197`*^9}, 
   3.548011606921111*^9, {3.5480131655537243`*^9, 3.5480132069383307`*^9}, 
   3.548023508732833*^9, 3.5480245531067657`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"fixsample", "[", "x_", "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"x", "-", "fullmean"}], ")"}], "/", "fullsd"}]}]], "Input",
 CellChangeTimes->{{3.548011184013399*^9, 3.548011234558681*^9}, {
  3.548011297684313*^9, 3.54801129941218*^9}, {3.548011391361576*^9, 
  3.5480113964881268`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"adjusteddata", "=", 
   RowBox[{"MapVecs", "[", 
    RowBox[{"fixsample", ",", "testdata"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.548011240047826*^9, 3.5480112626149693`*^9}, {
  3.548012292806053*^9, 3.5480122939636993`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"mat", ",", "vals"}], "}"}], "=", 
   RowBox[{"MakeLDA", "[", 
    RowBox[{"adjusteddata", ",", "12"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.548010069794486*^9, 3.5480100811621847`*^9}, {
  3.5480101132257843`*^9, 3.5480101226606894`*^9}, {3.548011634754801*^9, 
  3.548011636609853*^9}, {3.548011743088503*^9, 3.548011747053989*^9}, {
  3.548024483376033*^9, 3.548024512829749*^9}, {3.5480245864449663`*^9, 
  3.548024629315763*^9}}],

Cell[CellGroupData[{

Cell[BoxData["\<\"Within\"\>"], "Print",
 CellChangeTimes->{3.5480246222942247`*^9}],

Cell[BoxData["\<\"Between\"\>"], "Print",
 CellChangeTimes->{3.5480246222955914`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.09834242160676776`"}], ",", "0.21239407368338398`", 
       ",", 
       RowBox[{"-", "0.01406305668895514`"}], ",", 
       RowBox[{"-", "0.28324915555576996`"}], ",", "0.0018939984058853419`", 
       ",", 
       RowBox[{"-", "0.10362626433563416`"}], ",", 
       RowBox[{"-", "0.3989158870617274`"}], ",", "0.3518592176982677`", ",", 
       "0.5465933949475585`", ",", 
       RowBox[{"-", "0.43712634416668184`"}], ",", 
       RowBox[{"-", "0.019562829329466076`"}], ",", 
       RowBox[{"-", "0.22193469684012135`"}], ",", 
       RowBox[{"-", "0.015060505880588817`"}], ",", 
       RowBox[{"-", "0.10285054275601428`"}], ",", "0.14429948326413275`"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.3339160834871547`", ",", 
       RowBox[{"-", "0.10027806011313466`"}], ",", 
       RowBox[{"-", "0.37749484383238824`"}], ",", 
       RowBox[{"-", "0.08135631585205404`"}], ",", 
       RowBox[{"-", "0.25701183077107215`"}], ",", 
       RowBox[{"-", "0.15479160954632343`"}], ",", 
       RowBox[{"-", "0.3650072322109912`"}], ",", 
       RowBox[{"-", "0.23845949989015056`"}], ",", "0.4187802567859111`", ",", 
       RowBox[{"-", "0.03164990591619669`"}], ",", 
       RowBox[{"-", "0.27224545367268277`"}], ",", 
       RowBox[{"-", "0.25570856444957696`"}], ",", "0.21699038138232743`", 
       ",", "0.23928249782126865`", ",", 
       RowBox[{"-", "0.17026567484534155`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.17252352119458877`"}], ",", 
       RowBox[{"-", "0.021614439983640696`"}], ",", "0.05307001504294395`", 
       ",", "0.14087053227877336`", ",", "0.04870246856386407`", ",", 
       RowBox[{"-", "0.17263175739159045`"}], ",", 
       RowBox[{"-", "0.209876839580991`"}], ",", "0.30642025231334635`", ",", 
       
       RowBox[{"-", "0.26222115315282213`"}], ",", 
       RowBox[{"-", "0.06699166054007051`"}], ",", 
       RowBox[{"-", "0.18454322998277162`"}], ",", "0.347644897009918`", ",", 
       
       RowBox[{"-", "0.020290877982860323`"}], ",", "0.6809098372615441`", 
       ",", "0.29117225869228525`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.4458890344351634`", ",", "0.12732059303647905`", ",", 
       RowBox[{"-", "0.20664034817749324`"}], ",", 
       RowBox[{"-", "0.03827475883422524`"}], ",", 
       RowBox[{"-", "0.11326655968482789`"}], ",", 
       RowBox[{"-", "0.013650186971913225`"}], ",", "0.2019387570496717`", 
       ",", 
       RowBox[{"-", "0.011743833500647512`"}], ",", 
       RowBox[{"-", "0.32694999044538875`"}], ",", 
       RowBox[{"-", "0.5097612666237924`"}], ",", 
       RowBox[{"-", "0.06879610637874252`"}], ",", 
       RowBox[{"-", "0.265756096304235`"}], ",", "0.4588508753423939`", ",", 
       RowBox[{"-", "0.12852666489208409`"}], ",", "0.1330381259665204`"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.2306139583289972`", ",", "0.06313491183688634`", ",", 
       "0.06471445919195548`", ",", "0.025193504958687732`", ",", 
       "0.15197428457939907`", ",", 
       RowBox[{"-", "0.047385564242515194`"}], ",", 
       RowBox[{"-", "0.5261143743513889`"}], ",", 
       RowBox[{"-", "0.29430635978481867`"}], ",", "0.12156556744871441`", 
       ",", "0.322535908653597`", ",", "0.008784435965087423`", ",", 
       "0.3927938880179256`", ",", "0.2742088914003854`", ",", 
       "0.42397964992938175`", ",", "0.1453729824030628`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.25078991383690075`", ",", "0.15830929935501759`", ",", 
       RowBox[{"-", "0.019597660546457327`"}], ",", 
       RowBox[{"-", "0.07679045265890153`"}], ",", 
       RowBox[{"-", "0.04159582222569407`"}], ",", 
       RowBox[{"-", "0.14644412082395333`"}], ",", 
       RowBox[{"-", "0.04251805142096355`"}], ",", 
       RowBox[{"-", "0.31315930075252785`"}], ",", 
       RowBox[{"-", "0.3446955084610383`"}], ",", 
       RowBox[{"-", "0.5190652979097338`"}], ",", 
       RowBox[{"-", "0.18684253278257418`"}], ",", "0.018716617480915573`", 
       ",", "0.5948117548537479`", ",", "0.07345102592654577`", ",", 
       "0.0029698225947321463`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.16295652879858472`"}], ",", 
       RowBox[{"-", "0.1566313863583429`"}], ",", 
       RowBox[{"-", "0.03227483002798474`"}], ",", "0.08207571499906237`", 
       ",", "0.028222929010304116`", ",", "0.16911474122520784`", ",", 
       "0.07531955112520951`", ",", "0.3895063555523681`", ",", 
       "0.34179213810825265`", ",", "0.5784210174978152`", ",", 
       "0.19073693414911502`", ",", 
       RowBox[{"-", "0.06573375664120311`"}], ",", 
       RowBox[{"-", "0.4990389294093408`"}], ",", 
       RowBox[{"-", "0.061291409045235716`"}], ",", "0.09725426370652042`"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.10073223246691722`"}], ",", 
       RowBox[{"-", "0.4020393211925033`"}], ",", "0.010835228351686958`", 
       ",", 
       RowBox[{"-", "0.16448768748091558`"}], ",", 
       RowBox[{"-", "0.2046515353493127`"}], ",", 
       RowBox[{"-", "0.11751974659472084`"}], ",", 
       RowBox[{"-", "0.18989082611076186`"}], ",", "0.26293821028751224`", 
       ",", 
       RowBox[{"-", "0.11933504426631017`"}], ",", "0.019739075729732408`", 
       ",", 
       RowBox[{"-", "0.2339251269270307`"}], ",", "0.4284700614132978`", ",", 
       "0.4151457920455307`", ",", 
       RowBox[{"-", "0.427705509218428`"}], ",", 
       RowBox[{"-", "0.17871641311124492`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.05575917373014573`", ",", "0.23503680049884623`", ",", 
       "0.06818458959747661`", ",", "0.045458364782264726`", ",", 
       "0.10667592132159573`", ",", "0.025542124336436805`", ",", 
       "0.16498846342812146`", ",", 
       RowBox[{"-", "0.16507269735912658`"}], ",", "0.1936122555748262`", ",",
        "0.04378809504435618`", ",", "0.15028415178672624`", ",", 
       RowBox[{"-", "0.12653849866071237`"}], ",", 
       RowBox[{"-", "0.617923738474189`"}], ",", "0.22676459768348736`", ",", 
       "0.05343105969153523`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.10276495915985373`"}], ",", 
       RowBox[{"-", "0.181169537047354`"}], ",", "0.29472528952500265`", ",", 
       
       RowBox[{"-", "0.1396013670022503`"}], ",", "0.0005661290584837719`", 
       ",", 
       RowBox[{"-", "0.07915097530262197`"}], ",", "0.040283781754356957`", 
       ",", "0.037665499813059077`", ",", "0.0951226041089783`", ",", 
       "0.019379954943586204`", ",", 
       RowBox[{"-", "0.29816034741884045`"}], ",", "0.20627675508809873`", 
       ",", "0.`", ",", 
       RowBox[{"-", "0.15261369113639398`"}], ",", 
       RowBox[{"-", "0.17640203196942011`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.1267652395739612`", ",", "0.05890186271921454`", ",", 
       RowBox[{"-", "0.06371133569363654`"}], ",", "0.024480821700349036`", 
       ",", 
       RowBox[{"-", "0.17934341095179843`"}], ",", "0.03179362064152712`", 
       ",", "0.35651990067422257`", ",", "0.06784817531589911`", ",", 
       "0.16548735954413027`", ",", "0.041594412403655814`", ",", 
       RowBox[{"-", "0.15451162725985948`"}], ",", "0.009483274159376137`", 
       ",", "0.6498185260929891`", ",", "0.07135639370705456`", ",", 
       "0.400394488687528`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.16184078053207895`", ",", 
       RowBox[{"-", "0.13523536558240315`"}], ",", 
       RowBox[{"-", "0.07589339028895352`"}], ",", "0.06581959080748417`", 
       ",", "0.1075520769636624`", ",", 
       RowBox[{"-", "0.033125810548449985`"}], ",", 
       RowBox[{"-", "0.059801056439838754`"}], ",", "0.159963467620172`", ",", 
       RowBox[{"-", "0.03321106274140548`"}], ",", "0.13763674113424063`", 
       ",", 
       RowBox[{"-", "0.07139301608267942`"}], ",", 
       RowBox[{"-", "0.07809828738787722`"}], ",", "0.`", ",", 
       RowBox[{"-", "0.12059771065594582`"}], ",", "0.16726381259131398`"}], 
      "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.08488273996881847`", ",", "0.023919468156269434`", ",", 
     "0.009708019507863265`", ",", "0.006339046633172517`", ",", 
     "0.004627293451076222`", ",", "4.469328227640207`*^-17", ",", 
     "3.5443692811672235`*^-17", ",", 
     RowBox[{"-", "1.0869168131050197`*^-17"}], ",", 
     RowBox[{"-", "9.470141688651535`*^-18"}], ",", 
     RowBox[{"-", "9.470141688651535`*^-18"}], ",", "8.065980472806277`*^-18",
      ",", "8.065980472806277`*^-18"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.548024588582674*^9, 3.548024622310062*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"mat", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.54801066228631*^9, 3.548010664519286*^9}, {
  3.54801069758527*^9, 3.548010732181575*^9}}],

Cell[BoxData[
 TagBox["mat",
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.548010727745593*^9, 3.548010732725252*^9}, {
   3.548010787855385*^9, 3.548010806238196*^9}, 3.548011067422009*^9, {
   3.5480114969086037`*^9, 3.548011521159836*^9}, 3.548011566589512*^9, 
   3.5480116070194473`*^9, 3.548011646004959*^9, {3.548013185860264*^9, 
   3.5480132071856613`*^9}, 3.548024379722048*^9, 3.5480245532191887`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["vals"], "Input",
 CellChangeTimes->{{3.5480108445146427`*^9, 3.548010844816752*^9}}],

Cell[BoxData["vals"], "Output",
 CellChangeTimes->{3.548024386413801*^9, 3.548024553251639*^9}]
}, Open  ]]
},
WindowSize->{837, 690},
WindowMargins->{{29, Automatic}, {Automatic, 0}},
FrontEndVersion->"8.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (October 5, \
2011)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 85, 1, 27, "Input"],
Cell[667, 25, 375, 5, 27, "Output"]
}, Open  ]],
Cell[1057, 33, 47, 1, 27, "Input"],
Cell[1107, 36, 540, 12, 27, "Input"],
Cell[1650, 50, 2290, 50, 148, "Input"],
Cell[CellGroupData[{
Cell[3965, 104, 276, 6, 27, "Input"],
Cell[4244, 112, 3902, 85, 265, "Output"]
}, Open  ]],
Cell[8161, 200, 326, 8, 27, "Input"],
Cell[CellGroupData[{
Cell[8512, 212, 191, 4, 27, "Input"],
Cell[8706, 218, 8315, 178, 185, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17058, 401, 137, 2, 27, "Input"],
Cell[17198, 405, 621, 12, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17856, 422, 732, 13, 27, "Input"],
Cell[18591, 437, 535, 9, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19163, 451, 184, 3, 27, "Input"],
Cell[19350, 456, 531, 10, 27, "Output"]
}, Open  ]],
Cell[19896, 469, 522, 16, 27, "Input"],
Cell[CellGroupData[{
Cell[20443, 489, 238, 5, 27, "Input"],
Cell[20684, 496, 1592, 34, 57, "Output"]
}, Open  ]],
Cell[22291, 533, 336, 8, 27, "Input"],
Cell[22630, 543, 272, 6, 27, "Input"],
Cell[CellGroupData[{
Cell[22927, 553, 509, 11, 27, "Input"],
Cell[CellGroupData[{
Cell[23461, 568, 84, 1, 20, "Print"],
Cell[23548, 571, 85, 1, 20, "Print"]
}, Open  ]],
Cell[23648, 575, 8736, 174, 419, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32421, 754, 174, 3, 27, "Input"],
Cell[32598, 759, 452, 8, 39, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[33087, 772, 98, 1, 27, "Input"],
Cell[33188, 775, 95, 1, 27, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
