(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[      7731,        247]
NotebookOptionsPosition[      6690,        212]
NotebookOutlinePosition[      7044,        228]
CellTagsIndexPosition[      7001,        225]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"SetDirectory", "[", "\"\<~/Math/ML-Fun\>\"", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"<<", "ML`"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"noisematrix", "[", "r_", "]"}], ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"RandomVariate", "[", 
     RowBox[{"CauchyDistribution", "[", 
      RowBox[{"0", ",", "1"}], "]"}], "]"}], ",", 
    RowBox[{"{", "r", "}"}], ",", 
    RowBox[{"{", "20", "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.548062158963716*^9, 3.548062159786996*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"makesample", "[", 
   RowBox[{"mat_", ",", "nc_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"cl", "=", 
       RowBox[{"RandomVariate", "[", 
        RowBox[{"DiscreteUniformDistribution", "[", 
         RowBox[{"{", 
          RowBox[{"1", ",", "nc"}], "}"}], "]"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"factor2", "=", 
       RowBox[{"RandomVariate", "[", 
        RowBox[{"NormalDistribution", "[", "]"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"factor3", "=", 
       RowBox[{"RandomVariate", "[", 
        RowBox[{"NormalDistribution", "[", 
         RowBox[{"3", ",", "3"}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
      
      RowBox[{"factor4", "=", 
       RowBox[{"RandomVariate", "[", 
        RowBox[{"StudentTDistribution", "[", 
         RowBox[{"0", ",", "1", ",", "2"}], "]"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"fl", "=", 
       RowBox[{"x", "\[Function]", 
        RowBox[{"Join", "[", 
         RowBox[{"x", ",", 
          RowBox[{"Flatten", "[", 
           RowBox[{"Outer", "[", 
            RowBox[{"Times", ",", "x", ",", "x"}], "]"}], "]"}]}], 
         "]"}]}]}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"sample", "[", 
     RowBox[{"cl", ",", 
      RowBox[{"mat", ".", 
       RowBox[{"fl", "[", 
        RowBox[{"{", 
         RowBox[{"cl", ",", "factor2", ",", "factor3", ",", "factor4"}], 
         "}"}], "]"}]}]}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.548061730629533*^9, 3.5480618694696207`*^9}, {
   3.5480620186068087`*^9, 3.5480621423185253`*^9}, {3.548062347471837*^9, 
   3.5480623715840273`*^9}, 3.54806240619558*^9, {3.5480624779898567`*^9, 
   3.548062478546102*^9}, {3.548062508595479*^9, 3.5480625567522097`*^9}, {
   3.548062604466333*^9, 3.5480626333127203`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"testnoise", "=", 
   RowBox[{"noisematrix", "[", "25", "]"}]}], ";", 
  RowBox[{"testnoise", "//", "MatrixForm"}]}]], "Input",
 CellChangeTimes->{{3.5480628257266693`*^9, 3.548062825917759*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"testdata", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"makesample", "[", 
      RowBox[{"testnoise", ",", "8"}], "]"}], ",", 
     RowBox[{"{", "1000", "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5480247774374866`*^9, 3.548024779163631*^9}, {
  3.548062204472725*^9, 3.548062205608244*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"validationdata", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"makesample", "[", 
      RowBox[{"testnoise", ",", "8"}], "]"}], ",", 
     RowBox[{"{", "500", "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.548024781352173*^9, 3.548024795717042*^9}, {
  3.548062444041562*^9, 3.5480624444189987`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Take", "[", 
   RowBox[{"testdata", ",", "10"}], "]"}], "//", "TableForm"}]], "Input"],

Cell[BoxData[
 RowBox[{"Sort", "[", 
  RowBox[{"AllClasses", "[", "testdata", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.548062701256214*^9, 3.548062725033523*^9}}],

Cell[BoxData[
 RowBox[{"TallyClasses", "[", "testdata", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"ClassesFromGathered", "[", 
  RowBox[{"GatherData", "[", "testdata", "]"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"fullmean", ",", "fullsd"}], "}"}], "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m", "=", 
       RowBox[{"FullMatrix", "[", "testdata", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Mean", "[", "m", "]"}], ",", 
       RowBox[{"StandardDeviation", "[", "m", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{"fullmean", ",", "fullsd"}], "}"}], "//", "TableForm"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"fixsample", "[", "x_", "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"x", "-", "fullmean"}], ")"}], "/", "fullsd"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"adjusteddata", "=", 
   RowBox[{"MapVecs", "[", 
    RowBox[{"fixsample", ",", "testdata"}], "]"}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"mat", ",", "vals"}], "}"}], "=", 
   RowBox[{"MakeLDA", "[", 
    RowBox[{"adjusteddata", ",", "7"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5480253189744177`*^9, 3.548025319219227*^9}, {
  3.548026148071823*^9, 3.5480261486537*^9}, {3.548062864208379*^9, 
  3.548062864718227*^9}}],

Cell[BoxData[
 RowBox[{"mat", "//", "MatrixForm"}]], "Input"],

Cell[BoxData["vals"], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dimreduced", "=", 
   RowBox[{"MapVecs", "[", 
    RowBox[{
     RowBox[{"x", "\[Function]", 
      RowBox[{"mat", ".", "x"}]}], ",", "adjusteddata"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.5480260585786247`*^9, 3.5480261168724957`*^9}, 
   3.548026174046232*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mvf", "=", 
   RowBox[{"MultiVariateNormalClassifier", "[", "dimreduced", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.5480261930089273`*^9, 3.548026210124734*^9}}],

Cell[BoxData[
 RowBox[{"mvf", "[", 
  RowBox[{"GetVec", "[", 
   RowBox[{"First", "[", "dimreduced", "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.548026254275627*^9, 3.54802629292237*^9}, {
  3.54802634295303*^9, 3.548026345080286*^9}}],

Cell[BoxData[
 RowBox[{"First", "[", "dimreduced", "]"}]], "Input",
 CellChangeTimes->{{3.548026263743517*^9, 3.548026266433901*^9}}]
},
WindowSize->{837, 690},
WindowMargins->{{29, Automatic}, {Automatic, 0}},
FrontEndVersion->"8.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (October 5, \
2011)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 85, 1, 27, "Input"],
Cell[645, 23, 47, 1, 27, "Input"],
Cell[695, 26, 389, 10, 27, "Input"],
Cell[1087, 38, 1920, 47, 118, "Input"],
Cell[3010, 87, 229, 5, 27, "Input"],
Cell[3242, 94, 353, 9, 27, "Input"],
Cell[3598, 105, 358, 9, 27, "Input"],
Cell[3959, 116, 121, 3, 27, "Input"],
Cell[4083, 121, 167, 3, 27, "Input"],
Cell[4253, 126, 72, 1, 27, "Input"],
Cell[4328, 129, 116, 2, 27, "Input"],
Cell[4447, 133, 428, 14, 27, "Input"],
Cell[4878, 149, 117, 3, 27, "Input"],
Cell[4998, 154, 171, 5, 27, "Input"],
Cell[5172, 161, 153, 4, 27, "Input"],
Cell[5328, 167, 356, 9, 27, "Input"],
Cell[5687, 178, 61, 1, 27, "Input"],
Cell[5751, 181, 30, 0, 27, "Input"],
Cell[5784, 183, 311, 9, 27, "Input"],
Cell[6098, 194, 205, 5, 27, "Input"],
Cell[6306, 201, 244, 5, 27, "Input"],
Cell[6553, 208, 133, 2, 27, "Input"]
}
]
*)

(* End of internal cache information *)
