(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[      7137,        236]
NotebookOptionsPosition[      6098,        201]
NotebookOutlinePosition[      6452,        217]
CellTagsIndexPosition[      6409,        214]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"SetDirectory", "[", "\"\<~/Math/ML-Fun\>\"", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"<<", "ML`"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"noisematrix", "[", "r_", "]"}], ":=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"RandomVariate", "[", 
     RowBox[{"CauchyDistribution", "[", 
      RowBox[{"0", ",", "1"}], "]"}], "]"}], ",", 
    RowBox[{"{", "r", "}"}], ",", 
    RowBox[{"{", "6", "}"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makesample", "[", "mat_", "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"factor1", " ", "=", 
       RowBox[{"RandomVariate", "[", 
        RowBox[{"BinomialDistribution", "[", 
         RowBox[{"3", ",", ".5"}], "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"factor2", "=", 
       RowBox[{"RandomVariate", "[", 
        RowBox[{"DiscreteUniformDistribution", "[", 
         RowBox[{"{", 
          RowBox[{"0", ",", "2"}], "}"}], "]"}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"factor3", "=", 
       RowBox[{"RandomVariate", "[", 
        RowBox[{"DiscreteUniformDistribution", "[", 
         RowBox[{"{", 
          RowBox[{"1", ",", "8"}], "}"}], "]"}], "]"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"sample", "[", 
     RowBox[{
      RowBox[{"factor1", "+", "factor2", "+", "factor3"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"mat", ".", 
       RowBox[{"{", 
        RowBox[{
        "factor1", ",", "factor2", ",", "factor3", ",", "\[IndentingNewLine]", 
         RowBox[{"RandomVariate", "[", 
          RowBox[{"NormalDistribution", "[", "]"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"RandomVariate", "[", 
          RowBox[{"NormalDistribution", "[", 
           RowBox[{"0", ",", "5"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
         
         RowBox[{"RandomVariate", "[", 
          RowBox[{"StudentTDistribution", "[", 
           RowBox[{"0", ",", "1", ",", "2"}], "]"}], "]"}]}], "}"}]}]}], 
     "]"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"testnoise", "=", 
   RowBox[{"noisematrix", "[", "15", "]"}]}], ";", 
  RowBox[{"testnoise", "//", "MatrixForm"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"testdata", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"makesample", "[", "testnoise", "]"}], ",", 
     RowBox[{"{", "1000", "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5480247774374866`*^9, 3.548024779163631*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"validationdata", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"makesample", "[", "testnoise", "]"}], ",", 
     RowBox[{"{", "500", "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.548024781352173*^9, 3.548024795717042*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Take", "[", 
   RowBox[{"testdata", ",", "10"}], "]"}], "//", "TableForm"}]], "Input"],

Cell[BoxData[
 RowBox[{"TallyClasses", "[", "testdata", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"Length", "/@", 
  RowBox[{"FullMatrix", "/@", 
   RowBox[{"GatherData", "[", 
    RowBox[{"Take", "[", 
     RowBox[{"testdata", ",", "15"}], "]"}], "]"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{"ClassesFromGathered", "[", 
  RowBox[{"GatherData", "[", "testdata", "]"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"fullmean", ",", "fullsd"}], "}"}], "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m", "=", 
       RowBox[{"FullMatrix", "[", "testdata", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Mean", "[", "m", "]"}], ",", 
       RowBox[{"StandardDeviation", "[", "m", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{"fullmean", ",", "fullsd"}], "}"}], "//", "TableForm"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"fixsample", "[", "x_", "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"x", "-", "fullmean"}], ")"}], "/", "fullsd"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"adjusteddata", "=", 
   RowBox[{"MapVecs", "[", 
    RowBox[{"fixsample", ",", "testdata"}], "]"}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"mat", ",", "vals"}], "}"}], "=", 
   RowBox[{"MakeLDA", "[", 
    RowBox[{"adjusteddata", ",", "6"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5480253189744177`*^9, 3.548025319219227*^9}, {
  3.548026148071823*^9, 3.5480261486537*^9}}],

Cell[BoxData[
 RowBox[{"mat", "//", "MatrixForm"}]], "Input"],

Cell[BoxData["vals"], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dimreduced", "=", 
   RowBox[{"MapVecs", "[", 
    RowBox[{
     RowBox[{"x", "\[Function]", 
      RowBox[{"mat", ".", "x"}]}], ",", "adjusteddata"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.5480260585786247`*^9, 3.5480261168724957`*^9}, 
   3.548026174046232*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mvf", "=", 
   RowBox[{"MultiVariateNormalClassifier", "[", "dimreduced", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.5480261930089273`*^9, 3.548026210124734*^9}}],

Cell[BoxData[
 RowBox[{"mvf", "[", 
  RowBox[{"GetVec", "[", 
   RowBox[{"First", "[", "dimreduced", "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.548026254275627*^9, 3.54802629292237*^9}, {
  3.54802634295303*^9, 3.548026345080286*^9}}],

Cell[BoxData[
 RowBox[{"First", "[", "dimreduced", "]"}]], "Input",
 CellChangeTimes->{{3.548026263743517*^9, 3.548026266433901*^9}}]
},
WindowSize->{837, 690},
WindowMargins->{{29, Automatic}, {Automatic, 0}},
FrontEndVersion->"8.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (October 5, \
2011)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 85, 1, 27, "Input"],
Cell[645, 23, 47, 1, 27, "Input"],
Cell[695, 26, 322, 9, 27, "Input"],
Cell[1020, 37, 1640, 41, 148, "Input"],
Cell[2663, 80, 161, 4, 27, "Input"],
Cell[2827, 86, 277, 7, 27, "Input"],
Cell[3107, 95, 280, 7, 27, "Input"],
Cell[3390, 104, 121, 3, 27, "Input"],
Cell[3514, 109, 72, 1, 27, "Input"],
Cell[3589, 112, 193, 5, 27, "Input"],
Cell[3785, 119, 116, 2, 27, "Input"],
Cell[3904, 123, 428, 14, 27, "Input"],
Cell[4335, 139, 117, 3, 27, "Input"],
Cell[4455, 144, 171, 5, 27, "Input"],
Cell[4629, 151, 153, 4, 27, "Input"],
Cell[4785, 157, 307, 8, 27, "Input"],
Cell[5095, 167, 61, 1, 27, "Input"],
Cell[5159, 170, 30, 0, 27, "Input"],
Cell[5192, 172, 311, 9, 27, "Input"],
Cell[5506, 183, 205, 5, 27, "Input"],
Cell[5714, 190, 244, 5, 27, "Input"],
Cell[5961, 197, 133, 2, 27, "Input"]
}
]
*)

(* End of internal cache information *)
